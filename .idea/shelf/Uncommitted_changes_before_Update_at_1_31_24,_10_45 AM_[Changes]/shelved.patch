Index: module-api/src/main/java/kr/project/backend/common/PushContent.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package kr.project.backend.common;\n\nimport com.google.firebase.messaging.Message;\nimport com.google.firebase.messaging.Notification;\n\npublic class PushContent {\n    public static Message makeMessage(String targetToken, String title, String body) {\n        Notification notification = Notification\n                .builder()\n                .setTitle(title)\n                .setBody(body)\n                .build();\n        return Message\n                .builder()\n                .setNotification(notification)\n                .setToken(targetToken)\n                .build();\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/module-api/src/main/java/kr/project/backend/common/PushContent.java b/module-api/src/main/java/kr/project/backend/common/PushContent.java
--- a/module-api/src/main/java/kr/project/backend/common/PushContent.java	(revision db6f8dd20566a059b8837e2de93acfdb4e718105)
+++ b/module-api/src/main/java/kr/project/backend/common/PushContent.java	(date 1706665451975)
@@ -1,9 +1,13 @@
 package kr.project.backend.common;
 
 import com.google.firebase.messaging.Message;
+import com.google.firebase.messaging.MulticastMessage;
 import com.google.firebase.messaging.Notification;
 
+import java.util.List;
+
 public class PushContent {
+
     public static Message makeMessage(String targetToken, String title, String body) {
         Notification notification = Notification
                 .builder()
@@ -15,5 +19,17 @@
                 .setNotification(notification)
                 .setToken(targetToken)
                 .build();
+    }
+
+    public static MulticastMessage makeMessages(String title, String body, List<String> targetTokens) {
+        Notification notification = Notification.builder()
+                .setTitle(title)
+                .setBody(body)
+                .build();
+        return MulticastMessage.builder()
+                .setNotification(notification)
+                .addAllTokens(targetTokens)
+                .build();
+
     }
 }
Index: module-database/src/main/java/kr/project/backend/repository/user/UserRepository.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package kr.project.backend.repository.user;\n\n\nimport kr.project.backend.entity.user.User;\nimport org.springframework.data.jpa.repository.JpaRepository;\n\nimport java.util.Optional;\nimport java.util.UUID;\n\npublic interface UserRepository extends JpaRepository<User, String> {\n\n    Optional<User> findByUserEmail(String userEmail);\n\n    boolean existsByUserEmail(String userEmail);\n\n    int countByCreatedDateBetween(String startDate, String endDate);\n\n    int countByUserLoginDttmBetween(String startDate, String endDate);\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/module-database/src/main/java/kr/project/backend/repository/user/UserRepository.java b/module-database/src/main/java/kr/project/backend/repository/user/UserRepository.java
--- a/module-database/src/main/java/kr/project/backend/repository/user/UserRepository.java	(revision db6f8dd20566a059b8837e2de93acfdb4e718105)
+++ b/module-database/src/main/java/kr/project/backend/repository/user/UserRepository.java	(date 1706665371738)
@@ -4,6 +4,7 @@
 import kr.project.backend.entity.user.User;
 import org.springframework.data.jpa.repository.JpaRepository;
 
+import java.util.List;
 import java.util.Optional;
 import java.util.UUID;
 
@@ -16,4 +17,6 @@
     int countByCreatedDateBetween(String startDate, String endDate);
 
     int countByUserLoginDttmBetween(String startDate, String endDate);
+
+    List<User> findAllByUserEmailNotNull();
 }
Index: module-api/src/main/java/kr/project/backend/controller/admin/AdminController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package kr.project.backend.controller.admin;\n\n\nimport com.google.firebase.messaging.FirebaseMessagingException;\nimport io.swagger.v3.oas.annotations.Operation;\nimport io.swagger.v3.oas.annotations.Parameter;\nimport io.swagger.v3.oas.annotations.tags.Tag;\nimport kr.project.backend.dto.common.request.PushRequestDto;\nimport kr.project.backend.results.ListResult;\nimport kr.project.backend.service.admin.AdminService;\nimport kr.project.backend.common.Environment;\nimport kr.project.backend.results.ObjectResult;\nimport lombok.RequiredArgsConstructor;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.*;\n\n@Tag(name = \"관리자\", description = \"관리자 로그인\")\n@Slf4j\n@RestController\n@RequestMapping(\"/api/\" + Environment.API_VERSION + \"/\" + Environment.API_ADMIN)\n@RequiredArgsConstructor\npublic class AdminController {\n\n    private final AdminService adminService;\n\n    @Operation(summary = \"apiKey 발급\",description = \"관리자용 헤더 apikey를 발급합니다.\")\n    @GetMapping(\"/accessKey/{plainText}\")\n    public ResponseEntity<?> accessKey(@Parameter(name = \"plainText\", description = \"암호화 할 평문\", example = \"testText\")\n                                       @PathVariable(name = \"plainText\") String plainText) throws Exception{\n        return ObjectResult.build(adminService.giveApikey(plainText));\n    }\n    @Operation(summary = \"당일 가입 사용자 수\",description = \"당일 가입 사용자 수를 구한다.\")\n    @GetMapping(\"/today-register\")\n    public ResponseEntity<?> getTodayRegister(){\n        return ObjectResult.build(adminService.getTodayRegister());\n    }\n\n    @Operation(summary = \"당일 로그인 사용자 수\",description = \"당일 로그인 사용자 수를 구한다.\")\n    @GetMapping(\"/today-loginUser\")\n    public ResponseEntity<?> getTodayLoginUser(){\n        return ObjectResult.build(adminService.getTodayLoginUser());\n    }\n    @Operation(summary = \"당일 탈퇴 사용자 수\",description = \"당일 탈토ㅚ 사용자 수를 구한다.\")\n    @GetMapping(\"/today-dropUser\")\n    public ResponseEntity<?> getTodayDropUser(){\n        return ObjectResult.build(adminService.getTodayDropUser());\n    }\n\n    @Operation(summary = \"페이지 별 조회 수\",description = \"패아자 별 조회 수를 구한다.\")\n    @GetMapping(\"/page-view\")\n    public ResponseEntity<?> getPageView(){\n        return ListResult.build(adminService.getPageView());\n    }\n    @Operation(summary = \"푸시 토큰 발송\",description = \"푸시 토큰 발송을 한다.\")\n    @PostMapping(\"/send-push\")\n    public ResponseEntity<?> push(@RequestBody PushRequestDto pushRequestDto) throws FirebaseMessagingException{\n        adminService.sendPush(pushRequestDto);\n        return ObjectResult.ok();\n    }\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/module-api/src/main/java/kr/project/backend/controller/admin/AdminController.java b/module-api/src/main/java/kr/project/backend/controller/admin/AdminController.java
--- a/module-api/src/main/java/kr/project/backend/controller/admin/AdminController.java	(revision db6f8dd20566a059b8837e2de93acfdb4e718105)
+++ b/module-api/src/main/java/kr/project/backend/controller/admin/AdminController.java	(date 1706665122777)
@@ -6,6 +6,7 @@
 import io.swagger.v3.oas.annotations.Parameter;
 import io.swagger.v3.oas.annotations.tags.Tag;
 import kr.project.backend.dto.common.request.PushRequestDto;
+import kr.project.backend.dto.common.request.PushsRequestDto;
 import kr.project.backend.results.ListResult;
 import kr.project.backend.service.admin.AdminService;
 import kr.project.backend.common.Environment;
@@ -52,10 +53,16 @@
     public ResponseEntity<?> getPageView(){
         return ListResult.build(adminService.getPageView());
     }
-    @Operation(summary = "푸시 토큰 발송",description = "푸시 토큰 발송을 한다.")
+    @Operation(summary = "단일 푸시 토큰 발송",description = "단일 푸시 토큰 발송을 한다.")
     @PostMapping("/send-push")
     public ResponseEntity<?> push(@RequestBody PushRequestDto pushRequestDto) throws FirebaseMessagingException{
         adminService.sendPush(pushRequestDto);
         return ObjectResult.ok();
     }
+    @Operation(summary = "단체 푸시 토큰 발송",description = "단체 푸시 토큰 발송을 한다.")
+    @PostMapping("/send-pushs")
+    public ResponseEntity<?> pushs(@RequestBody PushsRequestDto pushsRequestDto) {
+        adminService.sendPushs(pushsRequestDto);
+        return ObjectResult.ok();
+    }
 }
\ No newline at end of file
Index: module-api/src/main/java/kr/project/backend/config/FirebaseConfig.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package kr.project.backend.config;\n\n\nimport com.google.auth.oauth2.GoogleCredentials;\nimport com.google.firebase.FirebaseApp;\nimport com.google.firebase.FirebaseOptions;\nimport com.google.firebase.messaging.FirebaseMessaging;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.util.ResourceUtils;\n\nimport java.io.FileInputStream;\nimport java.io.IOException;\n\n@Configuration\npublic class FirebaseConfig {\n    @Bean\n    public FirebaseApp firebaseApp() throws IOException {\n        FileInputStream aboutFirebaseFile = new FileInputStream(String.valueOf(ResourceUtils.getFile(\"/app/project/pushfile/stake-409504-firebase-adminsdk-pyfkg-d12d552dfb.json\")));\n        FirebaseOptions options = FirebaseOptions\n                .builder()\n                .setCredentials(GoogleCredentials.fromStream(aboutFirebaseFile))\n                .build();\n        return FirebaseApp.initializeApp(options);\n    }\n\n    @Bean\n    public FirebaseMessaging firebaseMessaging(FirebaseApp firebaseApp) {\n        return FirebaseMessaging.getInstance(firebaseApp);\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/module-api/src/main/java/kr/project/backend/config/FirebaseConfig.java b/module-api/src/main/java/kr/project/backend/config/FirebaseConfig.java
--- a/module-api/src/main/java/kr/project/backend/config/FirebaseConfig.java	(revision db6f8dd20566a059b8837e2de93acfdb4e718105)
+++ b/module-api/src/main/java/kr/project/backend/config/FirebaseConfig.java	(date 1706661306992)
@@ -16,7 +16,9 @@
 public class FirebaseConfig {
     @Bean
     public FirebaseApp firebaseApp() throws IOException {
-        FileInputStream aboutFirebaseFile = new FileInputStream(String.valueOf(ResourceUtils.getFile("/app/project/pushfile/stake-409504-firebase-adminsdk-pyfkg-d12d552dfb.json")));
+        //FileInputStream aboutFirebaseFile = new FileInputStream(String.valueOf(ResourceUtils.getFile("/app/project/pushfile/stake-409504-firebase-adminsdk-pyfkg-d12d552dfb.json")));
+        FileInputStream aboutFirebaseFile = new FileInputStream(String.valueOf(ResourceUtils.getFile("classpath:stake-409504-firebase-adminsdk-pyfkg-d12d552dfb.json")));
+
         FirebaseOptions options = FirebaseOptions
                 .builder()
                 .setCredentials(GoogleCredentials.fromStream(aboutFirebaseFile))
Index: module-api/src/main/java/kr/project/backend/service/admin/AdminService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package kr.project.backend.service.admin;\n\nimport com.google.firebase.messaging.FirebaseMessaging;\nimport com.google.firebase.messaging.FirebaseMessagingException;\nimport kr.project.backend.common.CommonErrorCode;\nimport kr.project.backend.common.CommonException;\nimport kr.project.backend.dto.admin.response.*;\nimport kr.project.backend.dto.common.request.PushRequestDto;\nimport kr.project.backend.entity.user.User;\nimport kr.project.backend.repository.user.DropUserRepository;\nimport kr.project.backend.repository.user.MoveViewRepository;\nimport kr.project.backend.repository.user.UserRepository;\nimport kr.project.backend.repository.user.UserUseClauseRepository;\nimport lombok.RequiredArgsConstructor;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport java.time.LocalDateTime;\nimport java.time.LocalTime;\nimport java.time.format.DateTimeFormatter;\nimport java.util.List;\n\nimport static kr.project.backend.common.PushContent.makeMessage;\nimport static kr.project.backend.utils.AesUtil.encryptAES256;\n\n\n@Service\n@RequiredArgsConstructor\n@Slf4j\npublic class AdminService {\n\n    @Value(\"${admin.aesKey}\")\n    private String adminAESKey;\n\n    @Value(\"${admin.aesIv}\")\n    private String adminAESIv;\n\n    private final UserRepository userRepository;\n    private final DropUserRepository dropUserRepository;\n    private final MoveViewRepository moveViewRepository;\n    private final FirebaseMessaging firebaseMessaging;\n    private final UserUseClauseRepository userUseClauseRepository;\n\n    public AccessKeyResponseDto giveApikey(String plainText) throws Exception {\n        return new AccessKeyResponseDto(encryptAES256(adminAESKey, adminAESIv, plainText + System.currentTimeMillis()));\n    }\n\n    @Transactional(readOnly = true)\n    public TodayRegisterResponseDto getTodayRegister() {\n        int todayRegister = userRepository.countByCreatedDateBetween(\n                LocalDateTime.of(LocalDateTime.now().toLocalDate(), LocalTime.MIN).format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\")),\n                LocalDateTime.of(LocalDateTime.now().toLocalDate(), LocalTime.MAX).format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\")));\n\n        return new TodayRegisterResponseDto(todayRegister);\n    }\n\n    @Transactional(readOnly = true)\n    public TodayLoginUserResponseDto getTodayLoginUser() {\n        int todayLoginUser = userRepository.countByUserLoginDttmBetween(\n                LocalDateTime.of(LocalDateTime.now().toLocalDate(), LocalTime.MIN).format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\")),\n                LocalDateTime.of(LocalDateTime.now().toLocalDate(), LocalTime.MAX).format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\")));\n\n        return new TodayLoginUserResponseDto(todayLoginUser);\n    }\n\n    @Transactional(readOnly = true)\n    public TodayDropUserResponseDto getTodayDropUser() {\n        int todayDropUser = dropUserRepository.countByDropDttmBetween(\n                LocalDateTime.of(LocalDateTime.now().toLocalDate(), LocalTime.MIN).format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\")),\n                LocalDateTime.of(LocalDateTime.now().toLocalDate(), LocalTime.MAX).format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\")));\n\n        return new TodayDropUserResponseDto(todayDropUser);\n    }\n\n    @Transactional(readOnly = true)\n    public List<PageViewDto> getPageView() {\n        return moveViewRepository.getPageViewInfo();\n    }\n\n    @Transactional(readOnly = true)\n    public void sendPush(PushRequestDto pushRequestDto) throws FirebaseMessagingException {\n        //유저 정보 조회\n        User userInfo = userRepository.findByUserEmail(pushRequestDto.getUserEmail())\n                .orElseThrow(() -> new CommonException(CommonErrorCode.NOT_FOUND_USER.getCode(), CommonErrorCode.NOT_FOUND_USER.getMessage()));\n        //푸시 전송\n        //TODO 발송 조건 추가\n        firebaseMessaging.send(makeMessage(userInfo.getUserPushToken(), pushRequestDto.getTitle(), pushRequestDto.getContent()));\n    }\n\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/module-api/src/main/java/kr/project/backend/service/admin/AdminService.java b/module-api/src/main/java/kr/project/backend/service/admin/AdminService.java
--- a/module-api/src/main/java/kr/project/backend/service/admin/AdminService.java	(revision db6f8dd20566a059b8837e2de93acfdb4e718105)
+++ b/module-api/src/main/java/kr/project/backend/service/admin/AdminService.java	(date 1706665451988)
@@ -6,6 +6,7 @@
 import kr.project.backend.common.CommonException;
 import kr.project.backend.dto.admin.response.*;
 import kr.project.backend.dto.common.request.PushRequestDto;
+import kr.project.backend.dto.common.request.PushsRequestDto;
 import kr.project.backend.entity.user.User;
 import kr.project.backend.repository.user.DropUserRepository;
 import kr.project.backend.repository.user.MoveViewRepository;
@@ -20,9 +21,11 @@
 import java.time.LocalDateTime;
 import java.time.LocalTime;
 import java.time.format.DateTimeFormatter;
+import java.util.ArrayList;
 import java.util.List;
 
 import static kr.project.backend.common.PushContent.makeMessage;
+import static kr.project.backend.common.PushContent.makeMessages;
 import static kr.project.backend.utils.AesUtil.encryptAES256;
 
 
@@ -79,6 +82,7 @@
         return moveViewRepository.getPageViewInfo();
     }
 
+
     @Transactional(readOnly = true)
     public void sendPush(PushRequestDto pushRequestDto) throws FirebaseMessagingException {
         //유저 정보 조회
@@ -86,7 +90,18 @@
                 .orElseThrow(() -> new CommonException(CommonErrorCode.NOT_FOUND_USER.getCode(), CommonErrorCode.NOT_FOUND_USER.getMessage()));
         //푸시 전송
         //TODO 발송 조건 추가
+
         firebaseMessaging.send(makeMessage(userInfo.getUserPushToken(), pushRequestDto.getTitle(), pushRequestDto.getContent()));
     }
 
+    public void sendPushs(PushsRequestDto pushsRequestDto) {
+        //유저 정보 조회
+        List<User> userInfos = userRepository.findAllByUserEmailNotNull();
+        List<String> targetTokens = new ArrayList<>();
+        targetTokens.add()
+        //TODO 발송 조건 추가
+        firebaseMessaging.send(makeMessages(pushsRequestDto.getTitle(), pushsRequestDto.getContent(), ))
+
+
+    }
 }
Index: module-database/src/main/java/kr/project/backend/dto/common/request/PushsRequestDto.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/module-database/src/main/java/kr/project/backend/dto/common/request/PushsRequestDto.java b/module-database/src/main/java/kr/project/backend/dto/common/request/PushsRequestDto.java
new file mode 100644
--- /dev/null	(date 1706665122779)
+++ b/module-database/src/main/java/kr/project/backend/dto/common/request/PushsRequestDto.java	(date 1706665122779)
@@ -0,0 +1,13 @@
+package kr.project.backend.dto.common.request;
+
+import lombok.Builder;
+import lombok.Data;
+
+import java.util.List;
+
+@Data
+@Builder
+public class PushsRequestDto {
+    private String title;
+    private String content;
+}
Index: module-api/src/main/java/kr/project/backend/config/SwaggerConfig.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package kr.project.backend.config;\n\nimport io.swagger.v3.oas.annotations.OpenAPIDefinition;\nimport io.swagger.v3.oas.annotations.info.Info;\nimport io.swagger.v3.oas.annotations.servers.Server;\nimport io.swagger.v3.oas.models.Components;\nimport io.swagger.v3.oas.models.OpenAPI;\nimport io.swagger.v3.oas.models.security.SecurityRequirement;\nimport io.swagger.v3.oas.models.security.SecurityScheme;\nimport lombok.RequiredArgsConstructor;\nimport org.springdoc.core.models.GroupedOpenApi;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@OpenAPIDefinition(\n        info = @Info(title = \"STAKING API 명세서\",\n                description = \"STAKING API 명세서 입니다.\",\n                version = \"v1\"),\n        servers = {@Server(url = \"https://api.s2it.kro.kr\")}) //prod\n        //servers = {@Server(url = \"/\")}) //local\n@RequiredArgsConstructor\n@Configuration\npublic class SwaggerConfig {\n    @Bean\n    public GroupedOpenApi userGroupApi() {\n        return GroupedOpenApi.builder()\n                .group(\"1\")\n                .displayName(\"사용자\")\n                .pathsToMatch(\"/api/v1/user/**\")\n                .build();\n    }\n\n    @Bean\n    public GroupedOpenApi adminGroupApi() {\n        return GroupedOpenApi.builder()\n                .group(\"2\")\n                .displayName(\"관리자\")\n                .pathsToMatch(\"/api/v1/admin/**\")\n                .build();\n    }\n\n    @Bean\n    public GroupedOpenApi commonGroupApi() {\n        return GroupedOpenApi.builder()\n                .group(\"3\")\n                .displayName(\"공통\")\n                .pathsToMatch(\"/api/v1/common/**\")\n                .build();\n    }\n\n    @Bean\n    public OpenAPI initOpenAPI() {\n        return new OpenAPI()\n                .info(new io.swagger.v3.oas.models.info.Info().title(\"TEST API\")\n                        .description(\"TEST API 명세서입니다.\")\n                        .version(\"v0.0.1\"))\n                .addSecurityItem(new SecurityRequirement().addList(\"Authorization\"))\n                .components(\n                        new Components().addSecuritySchemes(\n                                \"Authorization\",\n                                new SecurityScheme().type(SecurityScheme.Type.HTTP).scheme(\"bearer\").bearerFormat(\"JWT\").name(\"Authorization\")\n                        ));\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/module-api/src/main/java/kr/project/backend/config/SwaggerConfig.java b/module-api/src/main/java/kr/project/backend/config/SwaggerConfig.java
--- a/module-api/src/main/java/kr/project/backend/config/SwaggerConfig.java	(revision db6f8dd20566a059b8837e2de93acfdb4e718105)
+++ b/module-api/src/main/java/kr/project/backend/config/SwaggerConfig.java	(date 1706574100346)
@@ -16,8 +16,8 @@
         info = @Info(title = "STAKING API 명세서",
                 description = "STAKING API 명세서 입니다.",
                 version = "v1"),
-        servers = {@Server(url = "https://api.s2it.kro.kr")}) //prod
-        //servers = {@Server(url = "/")}) //local
+        //servers = {@Server(url = "https://api.s2it.kro.kr")}) //prod
+        servers = {@Server(url = "/")}) //local
 @RequiredArgsConstructor
 @Configuration
 public class SwaggerConfig {
